{"version":3,"file":"sitemapper.js","names":["XMLParser","got","zlib","pLimit","isGzip","Sitemapper","constructor","options","settings","requestHeaders","url","timeout","timeoutTable","lastmod","debug","concurrency","retries","rejectUnauthorized","fields","proxyAgent","exclusions","signal","fetch","a","arguments","b","_asyncToGenerator","length","aborted","Error","results","sites","errors","console","concat","crawl","e","error","name","message","duration","timestamp","option","parse","requestOptions","method","resolveWithFullResponse","gzip","responseType","headers","https","agent","requester","get","initializeTimeout","response","statusCode","clearTimeout","data","responseBody","rawBody","decompressResponseBody","body","parser","isArray","tagName","some","value","removeNSPrefix","toString","setTimeout","cancel","abortHandler","addEventListener","once","c","retryIndex","log","type","urlset","urlArray","Array","filter","site","modified","Date","getTime","isExcluded","loc","map","sitemap","field","active","Object","entries","sitemapindex","limit","promiseArray","Promise","all","result","reduce","prev","getSites","callback","warn","err","resolve","reject","buffer","Buffer","from","gunzip","pattern","test"],"sources":["../../src/assets/sitemapper.js"],"sourcesContent":["/**\n * Sitemap Parser\n *\n * Copyright (c) 2024 Sean Thomas Burke\n * Licensed under the MIT license.\n * @author Sean Burke <@seantomburke>\n */\n\nimport { XMLParser } from 'fast-xml-parser';\nimport got from 'got';\nimport zlib from 'zlib';\nimport pLimit from 'p-limit';\nimport isGzip from 'is-gzip';\n\n/**\n * @typedef {Object} Sitemapper\n */\nexport default class Sitemapper {\n  /**\n   * Construct the Sitemapper class\n   *\n   * @params {Object} options to set\n   * @params {string} [options.url] - the Sitemap url (e.g https://wp.seantburke.com/sitemap.xml)\n   * @params {Timeout} [options.timeout] - @see {timeout}\n   * @params {boolean} [options.debug] - Enables/Disables additional logging\n   * @params {integer} [options.concurrency] - The number of concurrent sitemaps to crawl (e.g. 2 will crawl no more than 2 sitemaps at the same time)\n   * @params {integer} [options.retries] - The maximum number of retries to attempt when crawling fails (e.g. 1 for 1 retry, 2 attempts in total)\n   * @params {boolean} [options.rejectUnauthorized] - If true (default), it will throw on invalid certificates, such as expired or self-signed ones.\n   * @params {lastmod} [options.lastmod] - the minimum lastmod value for urls\n   * @params {hpagent.HttpProxyAgent|hpagent.HttpsProxyAgent} [options.proxyAgent] - instance of npm \"hpagent\" HttpProxyAgent or HttpsProxyAgent to be passed to npm \"got\"\n   * @params {Array<RegExp>} [options.exclusions] - Array of regex patterns to exclude URLs\n   * @params {AbortSignal} [options.signal] - AbortSignal to cancel the request\n   *\n   * @example let sitemap = new Sitemapper({\n   *   url: 'https://wp.seantburke.com/sitemap.xml',\n   *   timeout: 15000,\n   *   lastmod: 1630693759,\n   *   exclusions: [/foo.com/, /bar.xml/], // Filters out URLs matching these patterns\n   *   signal: abortController.signal // For cancellation support\n   *  });\n   */\n  constructor(options) {\n    const settings = options || { requestHeaders: {} };\n    this.url = settings.url;\n    this.timeout = settings.timeout || 15000;\n    this.timeoutTable = {};\n    this.lastmod = settings.lastmod || 0;\n    this.requestHeaders = settings.requestHeaders;\n    this.debug = settings.debug;\n    this.concurrency = settings.concurrency || 10;\n    this.retries = settings.retries || 0;\n    this.rejectUnauthorized =\n      settings.rejectUnauthorized === false ? false : true;\n    this.fields = settings.fields || false;\n    this.proxyAgent = settings.proxyAgent || {};\n    this.exclusions = settings.exclusions || [];\n    this.signal = settings.signal;\n  }\n\n  /**\n   * Gets the sites from a sitemap.xml with a given URL\n   *\n   * @public\n   * @param {string} [url] - the Sitemaps url (e.g https://wp.seantburke.com/sitemap.xml)\n   * @param {Object} [options] - Additional options for this request\n   * @param {AbortSignal} [options.signal] - AbortSignal to cancel the request\n   * @returns {Promise<SitesData>}\n   * @example sitemapper.fetch('example.xml')\n   *  .then((sites) => console.log(sites));\n   * @example sitemapper.fetch('example.xml', { signal: abortController.signal })\n   *  .then((sites) => console.log(sites));\n   */\n  async fetch(url = this.url, options = {}) {\n    // Use signal from options or fallback to instance signal\n    const signal = options.signal || this.signal;\n\n    // Check if already aborted\n    if (signal && signal.aborted) {\n      throw new Error('Request was aborted');\n    }\n\n    // initialize empty variables\n    let results = {\n      url: '',\n      sites: [],\n      errors: [],\n    };\n\n    // attempt to set the variables with the crawl\n    if (this.debug) {\n      // only show if it's set\n      if (this.lastmod) {\n        console.debug(`Using minimum lastmod value of ${this.lastmod}`);\n      }\n    }\n\n    try {\n      // crawl the URL\n      results = await this.crawl(url, 0, signal);\n    } catch (e) {\n      // show errors that may occur\n      if (this.debug) {\n        console.error(e);\n      }\n\n      // Re-throw abort errors\n      if (e.name === 'AbortError' || e.message === 'Request was aborted') {\n        throw e;\n      }\n    }\n\n    return {\n      url,\n      sites: results.sites || [],\n      errors: results.errors || [],\n    };\n  }\n\n  /**\n   * Get the timeout\n   *\n   * @example console.log(sitemapper.timeout);\n   * @returns {Timeout}\n   */\n  static get timeout() {\n    return this.timeout;\n  }\n\n  /**\n   * Set the timeout\n   *\n   * @public\n   * @param {Timeout} duration\n   * @example sitemapper.timeout = 15000; // 15 seconds\n   */\n  static set timeout(duration) {\n    this.timeout = duration;\n  }\n\n  /**\n   * Get the lastmod minimum value\n   *\n   * @example console.log(sitemapper.lastmod);\n   * @returns {number}\n   */\n  static get lastmod() {\n    return this.lastmod;\n  }\n\n  /**\n   * Set the lastmod minimum value\n   *\n   * @public\n   * @param {number} timestamp\n   * @example sitemapper.lastmod = 1630694181; // Unix timestamp\n   */\n  static set lastmod(timestamp) {\n    this.lastmod = timestamp;\n  }\n\n  /**\n   *\n   * @param {string} url - url for making requests. Should be a link to a sitemaps.xml\n   * @example sitemapper.url = 'https://wp.seantburke.com/sitemap.xml'\n   */\n  static set url(url) {\n    this.url = url;\n  }\n\n  /**\n   * Get the url to parse\n   * @returns {string}\n   * @example console.log(sitemapper.url)\n   */\n  static get url() {\n    return this.url;\n  }\n\n  /**\n   * Setter for the debug state\n   * @param {boolean} option - set whether to show debug logs in output.\n   * @example sitemapper.debug = true;\n   */\n  static set debug(option) {\n    this.debug = option;\n  }\n\n  /**\n   * Getter for the debug state\n   * @returns {boolean}\n   * @example console.log(sitemapper.debug)\n   */\n  static get debug() {\n    return this.debug;\n  }\n\n  /**\n   * Requests the URL and uses fast-xml-parser to parse through and find the data\n   *\n   * @private\n   * @param {string} [url] - the Sitemaps url (e.g https://wp.seantburke.com/sitemap.xml)\n   * @param {AbortSignal} [signal] - AbortSignal to cancel the request\n   * @returns {Promise<ParseData>}\n   */\n  async parse(url = this.url, signal = null) {\n    // Check if already aborted\n    if (signal && signal.aborted) {\n      throw new Error('Request was aborted');\n    }\n\n    // setup the response options for the got request\n    const requestOptions = {\n      method: 'GET',\n      resolveWithFullResponse: true,\n      gzip: true,\n      responseType: 'buffer',\n      headers: this.requestHeaders,\n      https: {\n        rejectUnauthorized: this.rejectUnauthorized,\n      },\n      agent: this.proxyAgent,\n    };\n\n    // Add AbortSignal if provided\n    if (signal) {\n      requestOptions.signal = signal;\n    }\n\n    try {\n      // create a request Promise with the url and request options\n      const requester = got.get(url, requestOptions);\n\n      // initialize the timeout method based on the URL, and pass the request object.\n      this.initializeTimeout(url, requester, signal);\n\n      // get the response from the requester promise\n      const response = await requester;\n\n      // if the response does not have a successful status code then clear the timeout for this url.\n      if (!response || response.statusCode !== 200) {\n        clearTimeout(this.timeoutTable[url]);\n        return { error: response.error, data: response };\n      }\n\n      let responseBody;\n\n      if (isGzip(response.rawBody)) {\n        responseBody = await this.decompressResponseBody(response.body);\n      } else {\n        responseBody = response.body;\n      }\n\n      // Parse XML using fast-xml-parser\n      const parser = new XMLParser({\n        isArray: (tagName) =>\n          ['sitemap', 'url'].some((value) => value === tagName),\n        removeNSPrefix: true,\n      });\n\n      const data = parser.parse(responseBody.toString());\n\n      // return the results\n      return { error: null, data };\n    } catch (error) {\n      // Clear timeout on any error\n      clearTimeout(this.timeoutTable[url]);\n\n      // If the request was aborted\n      if (\n        error.name === 'AbortError' ||\n        error.message === 'Request was aborted'\n      ) {\n        throw error; // Re-throw abort errors to be handled by caller\n      }\n\n      // If the request was canceled notify the user of the timeout\n      if (error.name === 'CancelError') {\n        return {\n          error: `Request timed out after ${this.timeout} milliseconds for url: '${url}'`,\n          data: error,\n        };\n      }\n\n      // If an HTTPError include error http code\n      if (error.name === 'HTTPError') {\n        return {\n          error: `HTTP Error occurred: ${error.message}`,\n          data: error,\n        };\n      }\n\n      // Otherwise notify of another error\n      return {\n        error: `Error occurred: ${error.name}`,\n        data: error,\n      };\n    }\n  }\n\n  /**\n   * Timeouts are necessary for large xml trees. This will cancel the call if the request is taking\n   * too long, but will still allow the promises to resolve.\n   *\n   * @private\n   * @param {string} url - url to use as a hash in the timeoutTable\n   * @param {Promise} requester - the promise that creates the web request to the url\n   * @param {AbortSignal} [signal] - AbortSignal to listen for cancellation\n   */\n  initializeTimeout(url, requester, signal = null) {\n    // this will throw a CancelError which will be handled in the parent that calls this method.\n    this.timeoutTable[url] = setTimeout(() => requester.cancel(), this.timeout);\n\n    // If AbortSignal is provided, listen for abort events\n    if (signal) {\n      const abortHandler = () => {\n        clearTimeout(this.timeoutTable[url]);\n        requester.cancel();\n      };\n\n      if (signal.aborted) {\n        abortHandler();\n      } else {\n        signal.addEventListener('abort', abortHandler, { once: true });\n      }\n    }\n  }\n\n  /**\n   * Recursive function that will go through a sitemaps tree and get all the sites\n   *\n   * @private\n   * @param {string} url - the Sitemaps url (e.g https://wp.seantburke.com/sitemap.xml)\n   * @param {integer} retryIndex - number of retry attempts fro this URL (e.g. 0 for 1st attempt, 1 for second attempty etc.)\n   * @returns {Promise<SitesData>}\n   */\n  async crawl(url, retryIndex = 0, signal = null) {\n    try {\n      const { error, data } = await this.parse(url, signal);\n      // The promise resolved, remove the timeout\n      clearTimeout(this.timeoutTable[url]);\n\n      if (error) {\n        // Handle errors during sitemap parsing / request\n        // Retry on error until you reach the retry limit set in the settings\n        if (retryIndex < this.retries) {\n          if (this.debug) {\n            console.log(\n              `(Retry attempt: ${retryIndex + 1} / ${\n                this.retries\n              }) ${url} due to ${data.name} on previous request`\n            );\n          }\n          return this.crawl(url, retryIndex + 1, signal);\n        }\n\n        if (this.debug) {\n          console.error(\n            `Error occurred during \"crawl('${url}')\":\\n\\r Error: ${error}`\n          );\n        }\n\n        // Fail and log error\n        return {\n          sites: [],\n          errors: [\n            {\n              type: data.name,\n              message: error,\n              url,\n              retries: retryIndex,\n            },\n          ],\n        };\n      } else if (data && data.urlset && data.urlset.url) {\n        // Handle URLs found inside the sitemap\n        if (this.debug) {\n          console.debug(`Urlset found during \"crawl('${url}')\"`);\n        }\n\n        // Convert single object to array if needed\n        const urlArray = Array.isArray(data.urlset.url)\n          ? data.urlset.url\n          : [data.urlset.url];\n\n        // Begin filtering the urls\n        const sites = urlArray\n          .filter((site) => {\n            if (this.lastmod === 0) return true;\n            if (site.lastmod === undefined) return false;\n            const modified = new Date(site.lastmod).getTime();\n\n            return modified >= this.lastmod;\n          })\n          .filter((site) => {\n            return !this.isExcluded(site.loc);\n          })\n          .map((site) => {\n            if (!this.fields) {\n              return site.loc;\n            } else {\n              let fields = {};\n              if (this.fields.sitemap) {\n                fields.sitemap = url;\n              }\n              for (const [field, active] of Object.entries(this.fields)) {\n                if (active && site[field]) {\n                  fields[field] = site[field];\n                }\n              }\n              return fields;\n            }\n          });\n\n        return {\n          sites,\n          errors: [],\n        };\n      } else if (data && data.sitemapindex) {\n        // Handle child sitemaps found inside the active sitemap\n        if (this.debug) {\n          console.debug(`Additional sitemap found during \"crawl('${url}')\"`);\n        }\n        // Map each child url into a promise to create an array of promises\n        const sitemap = data.sitemapindex.sitemap\n          .map((map) => map.loc)\n          .filter((url) => {\n            return !this.isExcluded(url);\n          });\n\n        // Parse all child urls within the concurrency limit in the settings\n        const limit = pLimit(this.concurrency);\n        const promiseArray = sitemap.map((site) =>\n          limit(() => this.crawl(site, 0, signal))\n        );\n\n        // Make sure all the promises resolve then filter and reduce the array\n        const results = await Promise.all(promiseArray);\n        const sites = results\n          .filter((result) => result.errors.length === 0)\n          .reduce((prev, { sites }) => [...prev, ...sites], []);\n        const errors = results\n          .filter((result) => result.errors.length !== 0)\n          .reduce((prev, { errors }) => [...prev, ...errors], []);\n\n        return {\n          sites,\n          errors,\n        };\n      }\n\n      // Retry on error until you reach the retry limit set in the settings\n      if (retryIndex < this.retries) {\n        if (this.debug) {\n          console.log(\n            `(Retry attempt: ${retryIndex + 1} / ${\n              this.retries\n            }) ${url} due to ${data.name} on previous request`\n          );\n        }\n        return this.crawl(url, retryIndex + 1, signal);\n      }\n      if (this.debug) {\n        console.error(`Unknown state during \"crawl('${url})'\":`, error, data);\n      }\n\n      // Fail and log error\n      return {\n        sites: [],\n        errors: [\n          {\n            url,\n            type: data.name || 'UnknownStateError',\n            message: 'An unknown error occurred.',\n            retries: retryIndex,\n          },\n        ],\n      };\n    } catch (e) {\n      if (this.debug) {\n        this.debug && console.error(e);\n      }\n\n      // Re-throw abort errors\n      if (e.name === 'AbortError' || e.message === 'Request was aborted') {\n        throw e;\n      }\n    }\n  }\n\n  /**\n   * Gets the sites from a sitemap.xml with a given URL\n   *\n   * @deprecated\n   * @param {string} url - url to query\n   * @param {getSitesCallback} callback - callback for sites and error\n   * @callback\n   */\n  async getSites(url = this.url, callback) {\n    console.warn(\n      '\\r\\nWarning:',\n      'function .getSites() is deprecated, please use the function .fetch()\\r\\n'\n    );\n\n    let err = {};\n    let sites = [];\n    try {\n      const response = await this.fetch(url);\n      sites = response.sites;\n    } catch (error) {\n      err = error;\n    }\n    return callback(err, sites);\n  }\n\n  /**\n   * Decompress the gzipped response body using zlib.gunzip\n   *\n   * @param {Buffer} body - body of the gzipped file\n   * @returns {boolean}\n   */\n  async decompressResponseBody(body) {\n    return await new Promise((resolve, reject) => {\n      const buffer = Buffer.from(body);\n      zlib.gunzip(buffer, (err, result) => {\n        if (err) {\n          reject(err);\n        } else {\n          resolve(result);\n        }\n      });\n    });\n  }\n\n  /**\n   * Checks if a urls is excluded based on the exclusion patterns.\n   *\n   * @param {string} url - The URL to check.\n   * @returns {boolean} Returns true if the urls is excluded, false otherwise.\n   */\n  isExcluded(url) {\n    if (this.exclusions.length === 0) return false;\n    return this.exclusions.some((pattern) => pattern.test(url));\n  }\n}\n\n/**\n * Callback for the getSites method\n *\n * @callback getSitesCallback\n * @param {Object} error - error from callback\n * @param {Array} sites - an Array of sitemaps\n */\n\n/**\n * Timeout in milliseconds\n *\n * @typedef {number} Timeout\n * the number of milliseconds before all requests timeout. The promises will still resolve so\n * you'll still receive parts of the request, but maybe not all urls\n * default is 15000 which is 15 seconds\n */\n\n/**\n * Resolve handler type for the promise in this.parse()\n *\n * @typedef {Object} ParseData\n *\n * @property {Error} error that either comes from fast-xml-parser or `got` or custom error\n * @property {Object} data\n * @property {string} data.url - URL of sitemap\n * @property {Array} data.urlset - Array of returned URLs\n * @property {string} data.urlset.url - single Url\n * @property {Object} data.sitemapindex - index of sitemap\n * @property {string} data.sitemapindex.sitemap - Sitemap\n * @example {\n *   error: 'There was an error!'\n *   data: {\n *     url: 'https://linkedin.com',\n *     urlset: [{\n *       url: 'https://www.linkedin.com/project1'\n *     },[{\n *       url: 'https://www.linkedin.com/project2'\n *     }]\n *   }\n * }\n */\n\n/**\n * Resolve handler type for the promise in this.parse()\n *\n * @typedef {Object} SitesData\n *\n * @property {string} url - the original url used to query the data\n * @property {SitesArray} sites\n * @property {ErrorDataArray} errors\n * @example {\n *   url: 'https://linkedin.com/sitemap.xml',\n *   sites: [\n *     'https://linkedin.com/project1',\n *     'https://linkedin.com/project2'\n *   ],\n *   errors: [\n *      {\n *        type: 'CancelError',\n *        url: 'https://www.walmart.com/sitemap_tp1.xml',\n *        retries: 0\n *      },\n *      {\n *        type: 'HTTPError',\n *        url: 'https://www.walmart.com/sitemap_tp2.xml',\n *        retries: 0\n *      },\n *   ]\n * }\n */\n\n/**\n * An array of urls\n *\n * @typedef {string[]} SitesArray\n * @example [\n *   'https://www.google.com',\n *   'https://www.linkedin.com'\n * ]\n */\n\n/**\n * An array of Error data objects\n *\n * @typedef {ErrorData[]} ErrorDataArray\n * @example [\n *    {\n *      type: 'CancelError',\n *      url: 'https://www.walmart.com/sitemap_tp1.xml',\n *      retries: 0\n *    },\n *    {\n *      type: 'HTTPError',\n *      url: 'https://www.walmart.com/sitemap_tp2.xml',\n *      retries: 0\n *    },\n * ]\n */\n\n/**\n * An object containing details about the errors which occurred during the crawl\n *\n * @typedef {Object} ErrorData\n *\n * @property {string} type - The error type which was returned\n * @property {string} url - The sitemap URL which returned the error\n * @property {number} errors - The total number of retries attempted after receiving the first error\n * @example {\n *    type: 'CancelError',\n *    url: 'https://www.walmart.com/sitemap_tp1.xml',\n *    retries: 0\n * }\n */\n"],"mappings":"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","ignoreList":[]}